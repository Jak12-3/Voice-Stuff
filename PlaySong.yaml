# -> PlaySong <- #
## Searches media library for said song title and plays it
## on the chosen HA media player

# configuration.yaml
command_line: !include command_line.yaml
intent_script: !include intent_script.yaml
conversation: !include conversation.yaml

input_text:
  search1:
    name: search1
    initial: The Rolling Stones

# command_line.yaml
  - sensor:
      name: search_song
      command: "find /media/Music | grep -i {{states('input_text.search1')}}"
      value_template: '{{ value |replace("/media/Music/", "media-source://media_source/local/Music/") }}'
   
# intent_script.yaml
PlaySong:
  action:
    - service: input_text.set_value
      data: 
        value: {{song}}
      target:
        entity_id: input_text.search1
    - delay:
        hours: 0
        minutes: 0
        seconds: 2
        milliseconds: 0
    - service: media_player.play_media
      metadata: {}
      data:
        media_content_type: music
        media_content_id: "{{states('sensor.search_song')}}"
      target:
        entity_id: media_player.ha


# /custom_sentences/sv/IntentName.yaml      
language: "sv"
intents:
  PlaySong:
    data:
      - sentences:
          - "spela upp låten {song}"
lists:
  song:
    wildcard: true
    
# conversation.yaml
intents:
  PlaySong:
    - "spela upp låten {song}"        
          
          






